<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Selección de Productos de Amazon</title>
  <link rel="stylesheet" href="../assets/css/style.css"/>
  <link rel="icon" type="image/png" href="../assets/img/logo-marca.png">
  <meta name="theme-color" content="#e0eafc">
  <meta name="description" content="Descubre los mejores productos de cocina, utensilios y gadgets en Amazon con nuestras selecciones destacadas y categorías. Compras 100% seguras y ofertas diarias.">
  <!-- Open Graph para redes sociales -->
  <meta property="og:title" content="Selección de Productos de Amazon | Cocina y Hogar">
  <meta property="og:description" content="Descubre los mejores productos de cocina en Amazon. Ofertas diarias y envío rápido.">
  <meta property="og:image" content="../assets/img/og-image.jpg">
</head>
<body>
  <header>
    <!-- Banner de ofertas -->
    <div class="hero-banner" id="offerBanner">
      <div class="banner-content">
        <span class="banner-icon">🔥</span>
        <span class="banner-text">¡Ofertas exclusivas de Amazon cada día!</span>
      </div>
    </div>
    
    <div class="header-wrapper">
      <h1 class="page-title">Selección de Productos de Amazon</h1>
      <div class="social-icons">
        <a href="https://www.instagram.com/tu_cocina_ideal_/" target="_blank" rel="noopener noreferrer">
          <img src="../assets/img/instagram.svg" alt="Instagram"/>
        </a>
        <a href="https://www.youtube.com/@Tu_cocina_ideal" target="_blank" rel="noopener noreferrer">
          <img src="../assets/img/youtube.svg" alt="YouTube"/>
        </a>
        <a href="https://t.me/+87xav6EbwthiYzZk" target="_blank" rel="noopener noreferrer">
          <img src="../assets/img/telegram.svg" alt="Telegram"/>
        </a>
      </div>
    </div>
  </header>

  <main>
    <!-- Sección de Destacados -->
    <section class="featured-card">
      <h2>Productos Destacados</h2>
      <div class="featured-list" id="featured-list"></div>
    </section>

    <!-- Sección de Categorías -->
    <section class="categories-card">
      <h2>Categorías</h2>
      <p class="categories-intro">Encuentra tu próximo favorito en un clic</p>
      <div class="categories-grid" id="categories-grid"></div>
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p><span class="secure-icon">🔒</span> Compras 100% seguras en Amazon</p>
      <p>Esta página es un programa de afiliados de Amazon. Los productos se compran directamente en Amazon.</p>
      <p>&copy; 2025 Todos los derechos reservados.</p>
    </div>
  </footer>

  <script>
    fetch('../data/products.json')
      .then(res => res.json())
      .then(data => {
        // 1) Destacados: últimos 5
        const featuredList = document.getElementById('featured-list');
        data.slice(-5).reverse().forEach((p, index) => {
          const div = document.createElement('div');
          div.className = 'featured-item';
          // Añadir clase especial al 3er elemento (más vendido)
          if (index === 2) {
            div.className = 'featured-item featured-highlight';
          }
          div.innerHTML = `
            <div itemscope itemtype="http://schema.org/Product">
              <a href="${p.link}" target="_blank" rel="noopener noreferrer" itemprop="url">
                <img src="${p.image}" alt="${p.title}" itemprop="image" loading="lazy" width="160" height="130">
                <div class="product-title" itemprop="name">${p.title}</div>
              </a>
              <meta itemprop="brand" content="${p.brand || 'Marca'}">
              <meta itemprop="category" content="${p.category}">
              <div itemprop="offers" itemscope itemtype="http://schema.org/Offer">
                <meta itemprop="priceCurrency" content="EUR">
                <meta itemprop="price" content="${p.price || ''}">
                <link itemprop="availability" href="http://schema.org/InStock">
              </div>
            </div>
          `;
          featuredList.appendChild(div);
        });

        // 2) Categorías: collage de 4 por categoría
        const categories = [...new Set(data.map(p => p.category))];
        const grid = document.getElementById('categories-grid');
        categories.forEach(cat => {
          const items = data
            .filter(p => p.category === cat)
            .slice(-4)
            .reverse();
          
          // Crear un array con exactamente 4 elementos (usando placeholders si es necesario)
          const displayItems = [...items];
          while (displayItems.length < 4) {
            displayItems.push({
              image: "../assets/img/placeholder-light.png",
              title: "Placeholder",
              isPlaceholder: true
            });
          }
          
          const card = document.createElement('a');
          card.className = 'category-card';
          card.href = `categoria.html?category=${encodeURIComponent(cat)}`;
          
          card.innerHTML = `
            <div class="category-grid">
              ${displayItems.map(p => `
                <img src="${p.image}" alt="${p.isPlaceholder ? 'Placeholder' : p.title}" 
                     class="${p.isPlaceholder ? 'placeholder-img' : ''}"
                     loading="lazy">
              `).join('')}
            </div>
            <div class="category-title">${cat}</div>
          `;
          grid.appendChild(card);
        });
      })
      .catch(err => console.error('Error cargando productos:', err));
      
    // Banner que se oculta al hacer scroll
    let lastScrollTop = 0;
    const banner = document.getElementById('offerBanner');

    window.addEventListener('scroll', () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (scrollTop > lastScrollTop && scrollTop > 100) {
        banner.classList.add('hidden');
      } else {
        banner.classList.remove('hidden');
      }
      
      lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
    });
  </script>
</body>
</html>
